{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/wikindx-16.png","webpack:///./assets/wikindx-32.png","webpack:///./assets/wikindx-80.png","webpack:///./src/taskpane/wikindxMessages.js","webpack:///./src/taskpane/wikindxVisible.js","webpack:///./src/taskpane/wikindxXml.js","webpack:///./src/taskpane/wikindxStyles.js","webpack:///./src/taskpane/wikindxUrlManagement.js","webpack:///./src/taskpane/wikindxLocalStorage.js","webpack:///./src/taskpane/wikindxFinalize.js","webpack:///./src/taskpane/wikindxDisplayHelp.js","webpack:///./src/taskpane/taskpane.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","displayError","error","document","getElementById","style","display","displayErr","innerHTML","displaySuccess","success","displaySucc","xml","visibleElements","hideVisible","idArray","length","push","retrieveVisible","reset","searchURL","selectedURL","selectedName","errorXMLHTTP","xmlResponse","setSearchURL","text","getUrlSelectBox","jsonArray","len","href","userCheckHeartbeat","heartbeat","url","doXml","open","setRequestHeader","onerror","send","makeHttpObject","XMLHttpRequest","ActiveXObject","Error","wikindices","styleSelectBox","hrReturn","Xml","styles","wikindxURL","JSON","parse","window","localStorage","getItem","styleShort","styleLong","Visible","finalizeGetStyles","j","finalArray","tempLongNames","stylesFound","tempArray","filter","includes","sort","a","b","wikindicesPush","errorNewUrl","urlManagementDisplay","turnOn","displays","urlEditDisplay","urlEdit","trim","slice","selected_i","setItem","stringify","urlAddDisplay","urlRegister","numStoredURLs","Styles","urlPreferredDisplay","id","checked","onclick","urlPrefer","wikindxClose","querySelector","newArray","zeroth","urlDeleteDisplay","urlRemove","removeCount","split","keep","LocalStorage","removeItem","order","ascDesc","foundBibliography","bibliography","checkLocalStorage","displayUrlEntry","UrlManagement","src","wikindxDisplayAbout","wikindxDisplayReferencesHelp","wikindxDisplayCitationsHelp","wikindxDisplayFinalizeHelp","multipleWikindices","finalizeReferences","allItemObjects","multipleOrder","cleanIDs","citeIDs","finalizeDisplay","found","Word","run","context","cc","contentControls","load","sync","items","tag","atob","console","log","OfficeExtension","debugInfo","finalizeRun","urls","k","getCleanIDs","keys","params","finalizeGetReferencesXML","itemObject","item","itemText","insertHtml","finalizeGetCitationsXML","finalizeGetBibliography","getByTag","body","paragraphs","getLast","select","sel","getSelection","insertBreak","insertContentControl","color","title","then","metaId","creator","localeCompare","year","reverse","index","idString","ids","encodeURI","btoa","inTextReference","searchParams","bibEntry","indexOf","creatorOrder","titleOrder","yearOrder","docSelection","citation","initialId","errorMissingID","displayInit","Finalize","wikindxSearch","searchText","replace","search","sleep","ms","Promise","resolve","setTimeout","type","searchReferences","searchCitations","citeSelectBox","displayCitation","printSearchResultsCitations","refSelectBox","displayReference","printSearchResultsReferences","getReference","getCitation","html","insertReference","titleCC","insertCitation","ccRange","getRange","font","set","size","Office","onReady","info","config","extendedErrorLogging","host","HostType","requirements","isSetSupported","onreadystatechange","readyState","status","responseText","e","onchange","Help"],"mappings":"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","file":"taskpane.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 312);\n","module.exports = __webpack_public_path__ + \"c53ce4f2ee4d1f3c1f4158766525bc0f.png\";","module.exports = __webpack_public_path__ + \"6eb4b2f6b5b0a3799c71986453d1c449.png\";","module.exports = __webpack_public_path__ + \"d1e1978e7a8e1ee13dd25a81ddcacff7.png\";","export function displayError(error) {\r\n  document.getElementById(\"wikindx-display-results\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-finalize\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-success\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-finalize-working\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-working\").style.display = \"none\";\r\n\r\n  var displayErr = document.getElementById(\"wikindx-error\");\r\n  displayErr.innerHTML = error;\r\n  displayErr.style.display = \"block\";\r\n  document.getElementById(\"wikindx-messages\").style.display = \"block\";\r\n}\r\nexport function displaySuccess(success) {\r\n  document.getElementById(\"wikindx-display-results\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-finalize\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-error\").style.display = \"none\";\r\n\r\n  var displaySucc = document.getElementById(\"wikindx-success\");\r\n  displaySucc.innerHTML = success;\r\n  displaySucc.style.display = \"block\";\r\n  document.getElementById(\"wikindx-messages\").style.display = \"block\";\r\n}\r\n","export var visibleElements = [];\r\n\r\nexport function hideVisible(idArray) {\r\n  // store what is currently visible then hide\r\n  visibleElements = []; // Empty out storage . . .\r\n  for (var i = 0; i < idArray.length; i++) {\r\n    if (document.getElementById(idArray[i]).style.display != \"none\") {\r\n      visibleElements.push(idArray[i]);\r\n      document.getElementById(idArray[i]).style.display = \"none\";\r\n    }\r\n  }\r\n}\r\nexport function retrieveVisible() {\r\n  // Retrieve what was visible and show again\r\n  for (var i = 0; i < visibleElements.length; i++) {\r\n    document.getElementById(visibleElements[i]).style.display = \"block\";\r\n  }\r\n}\r\n\r\nexport function reset() {\r\n  document.getElementById(\"wikindx-display-results\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-messages\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-working\").style.display = \"none\"; \r\n  document.getElementById(\"wikindx-search-completed\").style.display = \"none\"; \r\n}\r\n\r\nexport function endPrintCitation() {\r\n  document.getElementById(\"wikindx-messages\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-ref\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-insert-refSection\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-refSelectBox\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-cite\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-insert-citeSection\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-display-results\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-citeSelectBox\").style.display = \"block\";\r\n}\r\n\r\nexport function endPrintReference() {\r\n  document.getElementById(\"wikindx-messages\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-cite\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-insert-citeSection\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-citeSelectBox\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-ref\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-insert-refSection\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-display-results\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-refSelectBox\").style.display = \"block\";\r\n}\r\n\r\nexport function displayReferencePane() {\r\n  hideVisible([\"wikindx-messages\", \"wikindx-display-results\", \"wikindx-citation-order\"]);\r\n  document.getElementById(\"wikindx-search-completed\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-action-title-citations\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-action-title-finalize\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-finalize\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-completed\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-working\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-citations-help\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-finalize-help\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-citations-help\").src = \"../../assets/lightbulb_off.png\";\r\n  document.getElementById(\"wikindx-display-finalize-help\").src = \"../../assets/lightbulb_off.png\";\r\n  document.getElementById(\"wikindx-action-title-references\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-reference-order\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-search-parameters\").style.display = \"block\";\r\n}\r\n\r\nexport function displayCitationPane() {\r\n  hideVisible([\"wikindx-messages\", \"wikindx-display-results\", \"wikindx-reference-order\"]);\r\n  document.getElementById(\"wikindx-search-completed\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-action-title-references\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-action-title-finalize\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-finalize\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-completed\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-working\").style.display = \"none\"; \r\n  document.getElementById(\"wikindx-references-help\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-finalize-help\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-references-help\").src = \"../../assets/lightbulb_off.png\";\r\n  document.getElementById(\"wikindx-display-finalize-help\").src = \"../../assets/lightbulb_off.png\";\r\n  document.getElementById(\"wikindx-action-title-citations\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-citation-order\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-search-parameters\").style.display = \"block\";\r\n}\r\n\r\nexport function displayFinalizePane() {\r\n  hideVisible([\"wikindx-messages\", \"wikindx-display-results\", \"wikindx-url-management\", \"wikindx-search-parameters\"]);\r\n  document.getElementById(\"wikindx-finalize-completed\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-action-title-references\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-action-title-citations\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-citations-help\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-references-help\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-citations-help\").src = \"../../assets/lightbulb_off.png\";\r\n  document.getElementById(\"wikindx-display-references-help\").src = \"../../assets/lightbulb_off.png\";\r\n  document.getElementById(\"wikindx-action-title-finalize\").style.display = \"block\";\r\n}","import { displayError, displaySuccess } from \"./wikindxMessages\";\r\n\r\n\r\nvar xml;\r\nvar errorJSON = \"ERROR: Unspecified error. This could be any number of things from not being able to connect to the WIKINDX to no resources found matching your search.\";\r\nvar errorAccess = 'The WIKINDX admin has not enabled read-only access.';\r\nvar successHeartbeat = \"Yes, I am alive and kicking. Try searching me . . .\";\r\nexport var errorXMLHTTP = \"ERROR: XMLHTTP error – could not connect to the WIKINDX.  <br/><br/>There could be any number of reasons for this including an incorrect WIKINDX URL, an incompatibility between this add-in and the WIKINDX, the WIKINDX admin has not enabled read-only access, a network error . . .\";\r\nexport var xmlResponse = null;\r\nexport var searchURL;\r\nexport var selectedURL;\r\nexport var selectedName;\r\n\r\nexport function setSearchURL(text) {\r\n  searchURL = text;\r\n  return true;\r\n}\r\n\r\n\r\nexport function getReference(id) {\r\n  var wikindxURL = document.getElementById(\"wikindx-url\");\r\n  var styleSelectBox = document.getElementById(\"wikindx-styleSelectBox\");\r\n  searchURL = wikindxURL.value \r\n    + \"office.php\" + '?method=getReference' \r\n    + '&style=' + encodeURI(styleSelectBox.value) \r\n    + '&id=' + encodeURI(id);\r\n  doXml();\r\n}\r\n\r\nexport function getCitation(id) {\r\n  var wikindxURL = document.getElementById(\"wikindx-url\");\r\n  var styleSelectBox = document.getElementById(\"wikindx-styleSelectBox\");\r\n  var html = '&withHtml=1';\r\n\r\n  if (document.getElementById(\"wikindx-citation-html\").checked) {\r\n    html = '&withHtml=0';\r\n  }\r\n  searchURL = wikindxURL.value \r\n    + \"office.php\" + '?method=getCitation' \r\n    + '&style=' + encodeURI(styleSelectBox.value) \r\n    + '&id=' + encodeURI(id)\r\n    + html;\r\n  doXml();\r\n}\r\n\r\nexport function finalizeGetReferences(wikindxURL, ids) {\r\n  var searchParams = document.getElementById(\"wikindx-finalize-order\");\r\n  var styleSelectBox = document.getElementById(\"wikindx-finalize-styleSelectBox\");\r\n  searchURL = wikindxURL\r\n    + \"office.php\" + '?method=getBib' \r\n    + '&style=' + encodeURI(styleSelectBox.value) \r\n    + '&searchParams=' + encodeURI(searchParams.value)\r\n    + '&ids=' + encodeURI(ids);\r\n  doXml();\r\n}\r\n\r\nexport function finalizeGetCitations(wikindxURL, ids) {\r\n  var styleSelectBox = document.getElementById(\"wikindx-finalize-styleSelectBox\");\r\n  searchURL = wikindxURL \r\n    + \"office.php\" + '?method=getCiteCCs' \r\n    + '&style=' + encodeURI(styleSelectBox.value) \r\n    + '&ids=' + encodeURI(ids);\r\n  doXml();\r\n}\r\n\r\nexport function getStyles() {\r\n  var wikindxURL = document.getElementById(\"wikindx-url\");\r\n  searchURL = wikindxURL.value \r\n    + \"office.php\" + '?method=getStyles';\r\n  doXml();\r\n  // As this is triggered from a change in the WIKINDX selection, store also the currently selected URL and name\r\n  var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n  selectedURL = wikindxURL.value;\r\n  for (var i = 0; i < jsonArray.length; i++) {\r\n    if (jsonArray[i][0] == selectedURL) {\r\n      selectedName = jsonArray[i][1];\r\n      break;\r\n    }\r\n  }\r\n  document.getElementById(\"wikindx-url-visit\").href = selectedURL;\r\n}\r\n\r\nexport function getUrlSelectBox(jsonArray) {\r\n  var len = jsonArray.length;\r\n  var i;\r\n  var text = '';\r\n  for (i = 0; i < len; i++) {\r\n    text += '<option value=\"' + jsonArray[i][0] + '\">' + jsonArray[i][1] + '</option>';\r\n    if (!i) {\r\n      selectedURL = jsonArray[i][0];\r\n      selectedName = jsonArray[i][1];\r\n    }\r\n  }\r\n  document.getElementById(\"wikindx-url\").innerHTML = text;\r\n  document.getElementById(\"wikindx-url-visit\").href = selectedURL;\r\n}\r\n\r\nexport function getSearchInputReferences(searchText) {\r\n  var searchParams = document.getElementById(\"wikindx-reference-params\");\r\n  var styleSelectBox = document.getElementById(\"wikindx-styleSelectBox\");\r\n  var wikindxURL = document.getElementById(\"wikindx-url\");\r\n\r\n  searchURL = wikindxURL.value \r\n    + \"office.php\" + '?method=getReferences' \r\n    + '&searchWord=' + encodeURI(searchText)\r\n    + '&style=' + encodeURI(styleSelectBox.value)\r\n    + '&searchParams=' + encodeURI(searchParams.value)\r\n  doXml();\r\n}\r\n\r\nexport function getSearchInputCitations(searchText) {\r\n  var searchParams = document.getElementById(\"wikindx-citation-params\");\r\n  var styleSelectBox = document.getElementById(\"wikindx-styleSelectBox\");\r\n  var wikindxURL = document.getElementById(\"wikindx-url\");\r\n  searchURL = wikindxURL.value \r\n    + \"office.php\" + '?method=getCitations' \r\n    + '&searchWord=' + encodeURI(searchText)\r\n    + '&style=' + encodeURI(styleSelectBox.value)\r\n    + '&searchParams=' + encodeURI(searchParams.value);\r\n  doXml();\r\n}\r\n\r\nexport function userCheckHeartbeat() {\r\n  if (heartbeat(document.getElementById(\"wikindx-url\").value) !== true) {\r\n    displayError(errorXMLHTTP);\r\n    return false;\r\n  }\r\n  displaySuccess(successHeartbeat);\r\n  return true;\r\n}\r\n\r\nexport function heartbeat(url) {\r\n  if (!url) {\r\n    url = document.getElementById(\"wikindx-url\").value;\r\n  }\r\n  searchURL = url + \"office.php\" + '?method=heartbeat';\r\n  doXml();\r\n  if (xmlResponse == null) {\r\n    return displayError(errorXMLHTTP);\r\n  } else if(xmlResponse == 'access denied'){\r\n    return displayError(errorAccess); \r\n  }\r\n  return true;\r\n}\r\n\r\nexport function doXml() {\r\n// For debugging – log message can be copied into a web browser . . .\r\n//  console.log('doXml(): ' + searchURL);\r\n  xmlResponse = null;\r\n  xml.open(\"POST\", searchURL, false);\r\n  xml.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n  xml.onerror = function() {displayError(errorXMLHTTP); return false;};\r\n  xml.send();\r\n}\r\nexport function prepareXml() {\r\n  xml = new makeHttpObject();\r\n  xml.onreadystatechange = function () {\r\n    if (xml.readyState == 4 && xml.status == 200) {\r\n      try {\r\n        xmlResponse = JSON.parse(xml.responseText);\r\n      }\r\n      catch (e) {\r\n        displayError(errorJSON);\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n  return true;\r\n}\r\nfunction makeHttpObject() {\r\n  try { return new XMLHttpRequest(); }\r\n  catch (error) { }\r\n  try { return new ActiveXObject(\"Msxml2.XMLHTTP\"); }\r\n  catch (error) { }\r\n  try { return new ActiveXObject(\"Microsoft.XMLHTTP\"); }\r\n  catch (error) { }\r\n  throw new Error(\"Could not create HTTP request object.\");\r\n}","import { displayError } from \"./wikindxMessages\";\r\nimport * as Visible from \"./wikindxVisible\";\r\nimport * as Xml from \"./wikindxXml\";\r\n\r\nexport var wikindices = [];\r\nvar errorStyles = \"ERROR: Either no styles are defined on the selected WIKINDX or there are no available in-text citation styles.\";\r\nvar errorStylesFinalize = \"ERROR: No available in-text citation styles found in any of the wikindices used in the document.\";\r\n\r\nexport function styleSelectBox() {\r\n  var hrReturn = Xml.heartbeat(false);\r\n  if (hrReturn !== true) {\r\n    displayError(hrReturn);\r\n    return false;\r\n  }\r\n  var styles = document.getElementById(\"wikindx-styles\");\r\n  var styleSelectBox = document.getElementById(\"wikindx-styleSelectBox\");\r\n  Xml.getStyles();\r\n  if (Xml.xmlResponse == null) {\r\n    displayError(Xml.errorXMLHTTP);\r\n    styles.style.display = \"none\";\r\n    return false;\r\n  }\r\n  var len = Xml.xmlResponse.length;\r\n  if (!len) {\r\n    displayError(errorStyles);\r\n    styles.style.display = \"none\";\r\n    return false;\r\n  }\r\n\r\n  var styleLong, styleShort, i;\r\n  var text = '';\r\n\r\n  for (i = 0; i < len; i++) {\r\n    styleShort = Xml.xmlResponse[i].styleShort;\r\n    styleLong = Xml.xmlResponse[i].styleLong;\r\n    text += '<option value=\"' + styleShort + '\">' + styleLong + '</option>';\r\n  }\r\n  styleSelectBox.innerHTML = text;\r\n  Visible.reset();\r\n  styles.style.display = \"block\";\r\n  return true;\r\n}\r\n\r\nexport function finalizeGetStyles() {\r\n  var finalArray = [];\r\n  var tempLongNames = new Object();\r\n  var styleLong, styleShort, i, j, len, url;\r\n  var text = '';\r\n  var stylesFound = false;\r\n  for (i = 0; i < wikindices.length; i++) {\r\n    var tempArray = [];\r\n    url = wikindices[i][0];\r\n    Xml.setSearchURL(url + \"office.php\" + '?method=getStyles');\r\n    Xml.doXml();\r\n    if (Xml.xmlResponse == null) {\r\n      displayError(Xml.errorXMLHTTP);\r\n      return false;\r\n    }\r\n    len = Xml.xmlResponse.length;\r\n    if (!len) {\r\n      continue;\r\n    }\r\n    stylesFound = true;\r\n    // first run through – gather all styles from first WIKINDX\r\n    if (!i) {\r\n      for (j = 0; j < len; j++) {\r\n        finalArray.push(Xml.xmlResponse[j].styleShort);\r\n        tempLongNames[Xml.xmlResponse[j].styleShort] = Xml.xmlResponse[j].styleLong;\r\n      }\r\n      continue;\r\n    } // else . . .\r\n    for (j = 0; j < len; j++) {\r\n      tempArray.push(Xml.xmlResponse[j].styleShort);\r\n      tempLongNames[Xml.xmlResponse[j].styleShort] = Xml.xmlResponse[j].styleLong;\r\n    }\r\n    finalArray = finalArray.filter(value => tempArray.includes(value));\r\n  }\r\n  if (!stylesFound) {\r\n    displayError(errorStylesFinalize);\r\n    return false;\r\n  }\r\n  if (!finalArray.length) {\r\n  // Get styles from wikindx with most intext references\r\n    wikindices.sort(function (a, b) { return b[1] - a[1]; });\r\n    url = wikindices[0][0];\r\n    Xml.setSearchURL(url + \"office.php\" + '?method=getStyles');\r\n    Xml.doXml();\r\n    finalArray = [];\r\n    tempLongNames = [];\r\n    len = Xml.xmlResponse.length;\r\n    for (j = 0; j < len; j++) {\r\n      finalArray.push(Xml.xmlResponse[j].styleShort);\r\n      tempLongNames[Xml.xmlResponse[j].styleShort] = Xml.xmlResponse[j].styleLong;\r\n    }\r\n  }\r\n  for (i = 0; i < finalArray.length; i++) {\r\n    styleShort = finalArray[i];\r\n    styleLong = tempLongNames[finalArray[i]];\r\n    text += '<option value=\"' + styleShort + '\">' + styleLong + '</option>';\r\n  }\r\n  document.getElementById(\"wikindx-finalize-styleSelectBox\").innerHTML = text;\r\n  return true;\r\n}\r\n\r\nexport function initWikindices() {\r\n  wikindices = [];\r\n}\r\nexport function wikindicesPush(url) {\r\n  var len = wikindices.length;\r\n  for (var i = 0; i < len; i++) {\r\n    if (url == wikindices[i][0]) {\r\n        wikindices[i][1]++;\r\n        return;\r\n    }\r\n  }\r\n  wikindices.push([url, 1]);\r\n}","import { displayError, displaySuccess } from \"./wikindxMessages\";\r\nimport * as Visible from \"./wikindxVisible\";\r\nimport * as Xml from \"./wikindxXml\";\r\nimport * as LocalStorage from \"./wikindxLocalStorage\";\r\nimport * as Styles from \"./wikindxStyles\";\r\n\r\nvar errorNewUrl = \"ERROR: Missing URL or name input.\";\r\nvar successEditUrl = \"Edited WIKINDX URL.\";\r\nvar errorDuplicateUrl = \"ERROR: Duplicate URL input.\";\r\nvar errorDuplicateName = \"ERROR: Duplicate name input.\";\r\nvar successNewUrl = \"Stored new WIKINDX: \";\r\nvar successRemoveUrl = \"Deleted WIKINDX URL(s).\";\r\nvar successRemoveAllUrls = \"Deleted all WIKINDX URLs.\";\r\nvar successPreferredUrl = \"Preference stored.\";\r\n\r\nexport function urlManagementDisplay(turnOn) {\r\n  var displays = [\"wikindx-url-entry\", \"wikindx-url-edit\", \"wikindx-urls-remove\", \"wikindx-urls-preferred\"];\r\n  for (var i = 0; i < displays.length; i++) {\r\n    if (displays[i] != turnOn) {\r\n      document.getElementById(displays[i]).style.display = \"none\";\r\n    }\r\n  }\r\n\r\n  Visible.hideVisible([\"wikindx-search-parameters\", \"wikindx-display-results\"]);\r\n  document.getElementById(\"wikindx-messages\").style.display = \"none\";\r\n  document.getElementById(turnOn).style.display = \"block\";\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"block\";\r\n}\r\nexport function urlEditDisplay() {\r\n  document.getElementById(\"wikindx-url-management-subtitle\").innerHTML = 'Edit WIKINDX';\r\n  document.getElementById(\"wikindx-edit-url\").value = Xml.selectedURL;\r\n  document.getElementById(\"wikindx-edit-name\").value = Xml.selectedName;\r\n  urlManagementDisplay(\"wikindx-url-edit\");\r\n}\r\nexport function urlEdit() {\r\n  var editUrl = document.getElementById(\"wikindx-edit-url\");\r\n  var url = editUrl.value.trim();\r\n  var editName = document.getElementById(\"wikindx-edit-name\");\r\n  var name = editName.value.trim();\r\n  if (!url) {\r\n    displayError(errorNewUrl);\r\n    return;\r\n  }\r\n  if (!name) {\r\n    displayError(errorNewUrl);\r\n    return;\r\n  }\r\n  // Add trailing '/'\r\n  if (url.slice(-1) != '/') {\r\n    url += '/';\r\n  }\r\n  if (url == Xml.selectedURL && name == Xml.selectedName) { // No change\r\n    Visible.visibleElements.push(\"wikindx-search-parameters\");\r\n    Visible.retrieveVisible();\r\n    document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n    displaySuccess(successEditUrl);\r\n    return;\r\n  }\r\n  var hrReturn = Xml.heartbeat(url);\r\n  if (hrReturn !== true) {\r\n    displayError(hrReturn);\r\n    return false;\r\n  }\r\n\r\n  var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n  // get index of original\r\n  for (var i = 0; i < jsonArray.length; i++) {\r\n    if (Xml.selectedURL == jsonArray[i][0]) {\r\n      var selected_i = i;\r\n      break;\r\n    }\r\n  }\r\n  for (var i = 0; i < jsonArray.length; i++) {\r\n    if (i == selected_i) {\r\n      continue;\r\n    }\r\n    if ((url == jsonArray[i][0])) {\r\n      displayError(errorDuplicateUrl);\r\n      return;\r\n    } else if (name == jsonArray[i][1]) {\r\n      displayError(errorDuplicateName);\r\n      return;\r\n    }\r\n  }\r\n  // If we get here, we're cleared to stored the edits\r\n  jsonArray[selected_i][0] = url;\r\n  jsonArray[selected_i][1] = name;\r\n\r\n  window.localStorage.setItem('wikindx-localStorage', JSON.stringify(jsonArray));\r\n  Xml.getUrlSelectBox(jsonArray);\r\n  Visible.visibleElements.push(\"wikindx-search-parameters\");\r\n  Visible.retrieveVisible();\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n  displaySuccess(successEditUrl);\r\n  return;\r\n}\r\nexport function urlAddDisplay() {\r\n  document.getElementById(\"wikindx-url-management-subtitle\").innerHTML = 'Add WIKINDX';\r\n  urlManagementDisplay(\"wikindx-url-entry\");\r\n}\r\nexport function urlRegister() {\r\n  var newUrl = document.getElementById(\"wikindx-new-url\");\r\n  var url = newUrl.value.trim();\r\n  var newName = document.getElementById(\"wikindx-new-url-name\");\r\n  var name = newName.value.trim();\r\n  if (!url) {\r\n    displayError(errorNewUrl);\r\n    return;\r\n  }\r\n  if (!name) {\r\n    displayError(errorNewUrl);\r\n    return;\r\n  }\r\n  // Add trailing '/'\r\n  if (url.slice(-1) != '/') {\r\n    url += '/';\r\n  }\r\n  var hrReturn = Xml.heartbeat(url);\r\n  if (hrReturn !== true) {\r\n    displayError(hrReturn);\r\n    return false;\r\n  }\r\n  if (window.localStorage.getItem('wikindx-localStorage') == null) {\r\n    var jsonArray = [[url, name]];\r\n  } else {\r\n    var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n    var len = jsonArray.length;\r\n    var i;\r\n    for (i = 0; i < len; i++) {\r\n      if ((url == jsonArray[i][0])) {\r\n        displayError(errorDuplicateUrl);\r\n        return;\r\n      } else if (name == jsonArray[i][1]) {\r\n        displayError(errorDuplicateName);\r\n        return;\r\n      }\r\n    }\r\n    jsonArray.push([url, name]);\r\n  }\r\n  LocalStorage.incrementNumStoredURLs();\r\n  if (LocalStorage.numStoredURLs > 1) {\r\n    document.getElementById(\"wikindx-url-preferred\").style.display = \"block\";\r\n  }\r\n  window.localStorage.setItem('wikindx-localStorage', JSON.stringify(jsonArray));\r\n  Xml.getUrlSelectBox(jsonArray);\r\n  Visible.visibleElements.push(\"wikindx-search-parameters\");\r\n  Visible.visibleElements.push(\"wikindx-action\");\r\n  Visible.retrieveVisible();\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n  Styles.styleSelectBox(); // Preload with first value from wikindx-url select box\r\n  displaySuccess(successNewUrl + name + ' (' + url + ')');\r\n  return;\r\n}\r\nexport function urlPreferredDisplay() {\r\n  var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n  var len = jsonArray.length;\r\n  var i, id;\r\n  var text = '';\r\n  var checked = 'checked';\r\n  for (i = 0; i < len; i++) {\r\n    if (i) {\r\n      checked = '';\r\n    }\r\n    id = jsonArray[i][1]; // The WIKINDX name\r\n    text += '<input type=\"radio\" id=\"' + id + '\" name=\"wikindx-preferred\" value=\"' + id + '\"' + checked + '>'\r\n      + '<label for=\"' + id + '\"> ' + jsonArray[i][1] + ': ' + jsonArray[i][0] + '</label><br/>';\r\n  }\r\n  text += '<button class=\"button\" id=\"wikindx-url-prefer\" alt=\"Set preferred WIKINDX\" title=\"Set preferred WIKINDX\">Store</button>';\r\n  text += '<button class=\"button\" id=\"wikindx-close-url-preferred\" alt=\"Close\" title=\"Close\">Close</button>';\r\n  document.getElementById(\"wikindx-url-management-subtitle\").innerHTML = 'Preferred WIKINDX';\r\n  document.getElementById(\"wikindx-urls-preferred\").innerHTML = text;\r\n  urlManagementDisplay(\"wikindx-urls-preferred\");\r\n  document.getElementById(\"wikindx-url-prefer\").onclick = urlPrefer;\r\n  document.getElementById(\"wikindx-close-url-preferred\").onclick = wikindxClose;\r\n}\r\nfunction urlPrefer() {\r\n  // What is in position [0] of the array is the preferrred URL . . .\r\n  var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n  var name = document.querySelector('input[name=\"wikindx-preferred\"]:checked').value;\r\n  var newArray = [];\r\n  var zeroth = [];\r\n\r\n  if (name != jsonArray[0][1]) { // Selected value not yet in position 0\r\n    zeroth = jsonArray[0];\r\n    for (var i = 1; i < jsonArray.length; i++) {\r\n      if (name == jsonArray[i][1]) {\r\n        newArray[0] = jsonArray[i];\r\n      } else {\r\n        newArray[i] = jsonArray[i];\r\n      }\r\n    }\r\n    newArray.push(zeroth);\r\n    window.localStorage.setItem('wikindx-localStorage', JSON.stringify(newArray));\r\n    Xml.getUrlSelectBox(newArray);\r\n    Styles.styleSelectBox();\r\n  }\r\n  Visible.retrieveVisible();\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-parameters\").style.display = \"block\";\r\n  displaySuccess(successPreferredUrl);\r\n  return;\r\n}\r\nexport function urlDeleteDisplay() {\r\n  var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n  var len = jsonArray.length;\r\n  var i, id;\r\n  var text = '';\r\n  for (i = 0; i < len; i++) {\r\n    id = jsonArray[i][0] + '--WIKINDX--' + jsonArray[i][1];\r\n    text += '<input type=\"checkbox\" id=\"' + id + '\" name=\"' + id + '\">'\r\n      + '<label for=\"' + id + '\"> ' + jsonArray[i][1] + ': ' + jsonArray[i][0] + '</label><br/>';\r\n  }\r\n  text += '<button class=\"button\" id=\"wikindx-url-remove\" alt=\"Delete URLs\" title=\"Delete URLs\">Delete URLs</button>';\r\n  text += '<button class=\"button\" id=\"wikindx-close-url-remove\" alt=\"Close\" title=\"Close\">Close</button>';\r\n  document.getElementById(\"wikindx-url-management-subtitle\").innerHTML = 'Delete WIKINDX';\r\n  document.getElementById(\"wikindx-urls-remove\").innerHTML = text;\r\n  urlManagementDisplay(\"wikindx-urls-remove\");\r\n  document.getElementById(\"wikindx-url-remove\").onclick = urlRemove;\r\n  document.getElementById(\"wikindx-close-url-remove\").onclick = wikindxClose;\r\n}\r\nfunction urlRemove() {\r\n  var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n  var len = jsonArray.length;\r\n  var i, id;\r\n  var removeCount = 0;\r\n  var split = [];\r\n  var keep = [];\r\n\r\n  // First compare\r\n  for (i = 0; i < len; i++) {\r\n    id = jsonArray[i][0] + '--WIKINDX--' + jsonArray[i][1];\r\n    if (document.getElementById(id).checked == false) {\r\n      split = id.split('--WIKINDX--');\r\n      keep.push([split[0], split[1]]);\r\n    } else {\r\n      ++removeCount;\r\n      LocalStorage.decrementNumStoredURLs();\r\n    }\r\n  }\r\n  if (!removeCount) {\r\n    urlDeleteDisplay();\r\n    return;\r\n  }\r\n  if (LocalStorage.numStoredURLs < 2) {\r\n    document.getElementById(\"wikindx-url-preferred\").style.display = \"none\";\r\n  }\r\n  if (removeCount == len) { // Have we completely emptied the list?\r\n    window.localStorage.removeItem('wikindx-localStorage');\r\n    document.getElementById(\"wikindx-about-begin\").style.display = \"block\";\r\n    document.getElementById(\"wikindx-urls-remove\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-action\").style.display = \"none\";\r\n    urlAddDisplay();\r\n    document.getElementById(\"wikindx-close-url-entry\").style.display = \"none\";\r\n    displaySuccess(successRemoveAllUrls);\r\n    return;\r\n  }\r\n  window.localStorage.setItem('wikindx-localStorage', JSON.stringify(keep));\r\n  Xml.getUrlSelectBox(keep);\r\n  Styles.styleSelectBox(); // Preload with first value from wikindx-url select box\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n  Visible.retrieveVisible();\r\n  displaySuccess(successRemoveUrl);\r\n}\r\n\r\n\r\nexport function wikindxClose() {\r\n  Visible.retrieveVisible();\r\n  document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-messages\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-parameters\").style.display = \"block\";\r\n}","import * as Visible from \"./wikindxVisible\";\r\nimport * as Xml from \"./wikindxXml\";\r\nimport * as UrlManagement from \"./wikindxUrlManagement\";\r\nimport * as Styles from \"./wikindxStyles\";\r\n\r\nexport var numStoredURLs = 0;\r\n\r\nexport function checkLocalStorage(displayUrlEntry) {\r\n  if (!localStorage()) {\r\n    document.getElementById(\"wikindx-search-parameters\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-close-url-entry\").style.display = \"none\";\r\n    if (displayUrlEntry) {\r\n      document.getElementById(\"wikindx-url-management-subtitle\").innerHTML = 'Add WIKINDX';\r\n      UrlManagement.urlManagementDisplay(\"wikindx-url-entry\");\r\n      document.getElementById(\"wikindx-about\").style.display = \"none\";\r\n    } else {\r\n      document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n      document.getElementById(\"wikindx-about\").style.display = \"block\";\r\n      document.getElementById(\"wikindx-about-begin\").style.display = \"block\";\r\n      document.getElementById(\"wikindx-display-about\").src = \"../../assets/lightbulb.png\";\r\n    }\r\n    return false;\r\n  } else {\r\n    if (!Visible.visibleElements.length) {\r\n      document.getElementById(\"wikindx-about-begin\").style.display = \"none\";\r\n      document.getElementById(\"wikindx-url-management\").style.display = \"none\";\r\n      document.getElementById(\"wikindx-search-parameters\").style.display = \"block\";\r\n      Styles.styleSelectBox(); // Preload with first value from wikindx-url select box\r\n    } else {\r\n      Visible.retrieveVisible();\r\n    }\r\n  }\r\n  return true;\r\n}\r\nexport function localStorage() {\r\n  if (window.localStorage.getItem('wikindx-localStorage') == null) {\r\n    return false;\r\n  }\r\n  var jsonArray = JSON.parse(window.localStorage.getItem('wikindx-localStorage'));\r\n  numStoredURLs = jsonArray.length;\r\n  if (numStoredURLs > 1) {\r\n    document.getElementById(\"wikindx-url-preferred\").style.display = \"block\";\r\n  }\r\n  Xml.getUrlSelectBox(jsonArray);\r\n  return true;\r\n}\r\n\r\nexport function incrementNumStoredURLs() {\r\n  ++numStoredURLs;\r\n}\r\n\r\nexport function decrementNumStoredURLs() {\r\n  -numStoredURLs;\r\n}","import { displayError } from \"./wikindxMessages\";\r\nimport * as Xml from \"./wikindxXml\";\r\nimport * as Styles from \"./wikindxStyles\";\r\n\r\nvar order, ascDesc, id;\r\nvar foundBibliography;\r\nvar bibliography;\r\nvar finalizeReferences = [];\r\nvar allItemObjects = [];\r\nvar multipleOrder = [];\r\nvar multipleWikindices;\r\nvar cleanIDs = new Object();\r\nvar citeIDs = new Object();\r\nvar errorNoInserts = \"You have not inserted any references or citations yet so there is nothing to finalize.\";\r\n\r\nexport function finalizeDisplay() {\r\n  // Before displaying the pane, check we have references and remove any empty wikindx-based custom contexts\r\n  var found = false;\r\n  var url;\r\n\r\n  Styles.initWikindices();\r\n  Word.run(async function (context) {\r\n    var cc = context.document.contentControls.load('items');\r\n    var split;\r\n    await context.sync();\r\n    for (var i = 0; i < cc.items.length; i++) {\r\n      split = cc.items[i].tag.split('-');\r\n      if ((split.length > 1) && (split[0] === 'wikindx') && (cc.items[i].text.trim() === '')) {\r\n        cc.items[i].delete();\r\n        continue;\r\n      }\r\n      // 'looking for wikindx-id-{[JSON string/array]}'\r\n      if ((split.length < 3)\r\n        || (split[0] != 'wikindx')) {\r\n        continue;\r\n      }\r\n      if (split[1] != 'id') {\r\n        continue;\r\n      }\r\n      // If we get here, we have references\r\n      found = true;\r\n      url = JSON.parse(atob(split[2]))[0];\r\n      Styles.wikindicesPush(url);\r\n    }\r\n    if (!found) { // Nothing stored yet for this document\r\n      displayError(errorNoInserts);\r\n      return false;\r\n    }\r\n    // If we get here, there is something to finalize . . .\r\n    if (Styles.finalizeGetStyles()) {\r\n      document.getElementById(\"wikindx-finalize\").style.display = \"block\";\r\n    }\r\n  })\r\n    .catch(function (error) {\r\n      console.log(\"Error: \" + error);\r\n      if (error instanceof OfficeExtension.Error) {\r\n        console.log(\"Debug info: \" + JSON.stringify(error.debugInfo));\r\n        displayError(JSON.stringify(error));\r\n        return false;\r\n      }\r\n    });\r\n}\r\nexport function finalizeRun() {\r\n  var split, urls, i, j, k, cc;\r\n  foundBibliography = false;\r\n  bibliography = '';\r\n  finalizeReferences = [];\r\n  allItemObjects = [];\r\n  multipleOrder = [];\r\n  cleanIDs = new Object();\r\n  citeIDs = new Object();\r\n\r\n  document.getElementById(\"wikindx-finalize-working\").style.display = \"block\";\r\n  document.getElementById(\"wikindx-finalize-completed\").style.display = \"none\";\r\n\r\n  Word.run(async function (context) {\r\n    cc = context.document.contentControls.load(\"items\");\r\n    await context.sync();\r\n    getCleanIDs(cc);\r\n    // get references from WIKINDX\r\n    urls = Object.keys(cleanIDs);\r\n    multipleWikindices = false;\r\n    if (urls.length > 1) {\r\n      multipleWikindices = true;\r\n      var params = document.getElementById(\"wikindx-finalize-order\").value;\r\n      split = params.split('_');\r\n      order = split[0];\r\n      ascDesc = split[1];\r\n    }\r\n    for (i = 0; i < urls.length; i++) {\r\n      finalizeGetReferencesXML(context, urls[i], JSON.stringify(cleanIDs[urls[i]]));\r\n    }\r\n    await context.sync();\r\n    for (j = 0; j < allItemObjects.length; j++) {\r\n      let itemObject = allItemObjects[j];\r\n      for (k = 0; k < itemObject.cc.items.length; k++) {\r\n        let item = itemObject.cc.items[k];\r\n        let itemText = itemObject.text;\r\n        item.insertHtml(itemText, 'Replace');\r\n      }\r\n    }\r\n// This is a real performance killer. In a total process of 10 seconds, this context.sync() takes about 9,5 seconds . . .\r\n// However, putting the context in the loop above slows it down even more as it is called repeatedly.\r\n// It is unfortunately necessary to have it here . . .\r\n    await context.sync();\r\n    // get citation references from WIKINDX\r\n    urls = Object.keys(citeIDs);\r\n    for (i = 0; i < urls.length; i++) {\r\n      finalizeGetCitationsXML(context, urls[i], JSON.stringify(citeIDs[urls[i]]));\r\n    }\r\n    await context.sync();\r\n    for (j = 0; j < allItemObjects.length; j++) {\r\n      let itemObject = allItemObjects[j];\r\n      for (k = 0; k < itemObject.cc.items.length; k++) {\r\n        let item = itemObject.cc.items[k];\r\n        let itemText = itemObject.text;\r\n        item.insertHtml(itemText, 'Replace');\r\n      }\r\n    }\r\n    finalizeGetBibliography();\r\n    if (foundBibliography) {\r\n      cc = context.document.contentControls.getByTag('wikindx-bibliography');\r\n      cc.load('items');\r\n      await context.sync();\r\n      cc.items[0].insertHtml(bibliography, \"Replace\");\r\n    } else {\r\n      context.document.body.paragraphs.getLast().select(\"End\");\r\n      var sel = context.document.getSelection();\r\n      sel.insertBreak(\"Line\", \"After\");\r\n      sel.insertBreak(\"Line\", \"After\");\r\n      context.document.body.paragraphs.getLast().select(\"End\");\r\n      sel = context.document.getSelection();\r\n      cc = sel.insertContentControl();\r\n      cc.color = 'orange';\r\n      cc.tag = 'wikindx-bibliography';\r\n      cc.title = 'Bibliography';\r\n      cc.insertHtml(bibliography, \"End\");\r\n    }\r\n  }) // There is an implicit context.sync() when Word.run() closes . . .\r\n    .then(function () {\r\n      document.getElementById(\"wikindx-finalize-working\").style.display = \"none\";\r\n      document.getElementById(\"wikindx-finalize-completed\").style.display = \"block\";\r\n    })\r\n    .catch(function (error) {\r\n      console.log(\"Error: \" + error);\r\n      if (error instanceof OfficeExtension.Error) {\r\n        console.log(\"Debug info: \" + JSON.stringify(error.debugInfo));\r\n        displayError(JSON.stringify(error));\r\n        return false;\r\n      }\r\n    });\r\n}\r\nfunction getCleanIDs(cc) {\r\n  var i, item, metaId;\r\n  var split = [];\r\n  for (i = 0; i < cc.items.length; i++) {\r\n    if (cc.items[i].tag == 'wikindx-bibliography') {\r\n      foundBibliography = true;\r\n      continue;\r\n    }\r\n    split = cc.items[i].tag.split('-');\r\n    if ((split.length < 3) // 'looking for wikindx-id-{[JSON string/array]}'\r\n      || (split[0] != 'wikindx')) {\r\n      continue;\r\n    }\r\n    if (split[1] != 'id') {\r\n      continue;\r\n    }\r\n    item = JSON.parse(atob(split[2]));\r\n    id = item[1];\r\n    if (item.length == 3) { // citation\r\n      metaId = item[2];\r\n      if (!(item[0] in citeIDs)) {\r\n        citeIDs[item[0]] = [metaId];\r\n      } else if (!citeIDs[item[0]].includes(metaId)) {\r\n        citeIDs[item[0]].push(metaId);\r\n      }\r\n    }\r\n    if (!(item[0] in cleanIDs)) {\r\n      cleanIDs[item[0]] = [id];\r\n    } else if (!cleanIDs[item[0]].includes(id)) {\r\n      cleanIDs[item[0]].push(id);\r\n    }\r\n  }\r\n}\r\nfunction finalizeGetBibliography() {\r\n  var i, key;\r\n  if (!multipleWikindices) {\r\n    for (i = 0; i < finalizeReferences.length; i++) {\r\n      bibliography += '<p>' + finalizeReferences[i] + '</p>';\r\n    }\r\n  } else {\r\n    if (order == 'creator') {\r\n      multipleOrder.sort(function (a, b) {\r\n        return a.creator.localeCompare(b.creator) || a.year - b.year || a.title.localeCompare(b.title);\r\n      });\r\n    }\r\n    else if (order == 'title') {\r\n      multipleOrder.sort(function (a, b) {\r\n        return a.title.localeCompare(b.title) || a.creator.localeCompare(b.creator) || a.year - b.year;\r\n      });\r\n    } else { // year\r\n      multipleOrder.sort(function (a, b) {\r\n        return a.year - b.year || a.creator.localeCompare(b.creator) || a.title.localeCompare(b.title);\r\n      });\r\n    }\r\n    if (ascDesc == 'DESC') {\r\n      multipleOrder.reverse();\r\n    }\r\n    for (i = 0; i < multipleOrder.length; i++) {\r\n      key = multipleOrder[i].index;\r\n      bibliography += '<p>' + finalizeReferences[key] + '</p>';\r\n    }\r\n  }\r\n}\r\nfunction finalizeGetCitationsXML(context, url, idString) {\r\n  var tag, cc, j;\r\n  Xml.finalizeGetCitations(url, idString);\r\n  // Replace in-text references\r\n  allItemObjects = []; // Reset . . .\r\n  for (j = 0; j < Xml.xmlResponse.length; j++) {\r\n    tag = 'wikindx-id-' + btoa(JSON.stringify([url, Xml.xmlResponse[j].id, Xml.xmlResponse[j].metaId]));\r\n    cc = context.document.contentControls.getByTag(tag);\r\n    cc.load('items');\r\n    let items = {\r\n      cc: cc,\r\n      text: Xml.xmlResponse[j].inTextReference\r\n    };\r\n    allItemObjects.push(items);\r\n  }\r\n}\r\n\r\nfunction finalizeGetReferencesXML(context, url, idString) {\r\n  var key, tag, cc, j;\r\n\r\n  Xml.finalizeGetReferences(url, idString);\r\n  // Replace in-text references\r\n  for (j = 0; j < Xml.xmlResponse.length; j++) {\r\n    tag = 'wikindx-id-' + btoa(JSON.stringify([url, Xml.xmlResponse[j].id]));\r\n    cc = context.document.contentControls.getByTag(tag);\r\n    cc.load('items');\r\n    let items = {\r\n      cc: cc,\r\n      text: Xml.xmlResponse[j].inTextReference\r\n    };\r\n    allItemObjects.push(items);\r\n    if (!finalizeReferences.includes(Xml.xmlResponse[j].bibEntry)) {\r\n      finalizeReferences.push(Xml.xmlResponse[j].bibEntry);\r\n      if (multipleWikindices) {\r\n        key = finalizeReferences.indexOf(Xml.xmlResponse[j].bibEntry);\r\n        multipleOrder.push({\r\n          \"index\": key,\r\n          \"creator\": Xml.xmlResponse[j].creatorOrder,\r\n          \"title\": Xml.xmlResponse[j].titleOrder,\r\n          \"year\": Xml.xmlResponse[j].yearOrder\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Display help and about messages\r\n */\r\n\r\nimport * as Visible from \"./wikindxVisible\";\r\nimport * as LocalStorage from \"./wikindxLocalStorage\";\r\n\r\nexport function wikindxDisplayAbout() {\r\n// Show About\r\n  if (document.getElementById(\"wikindx-about\").style.display == \"none\") {\r\n    if (LocalStorage.localStorage()) {\r\n      document.getElementById(\"wikindx-about-begin\").style.display = \"none\";\r\n    } else {\r\n      document.getElementById(\"wikindx-about-begin\").style.display = \"block\";\r\n    }\r\n    document.getElementById(\"wikindx-about\").style.display = \"block\";\r\n    Visible.hideVisible([\"wikindx-url-management\", \"wikindx-messages\", \"wikindx-display-results\", \"wikindx-search-parameters\", \r\n      \"wikindx-finalize\", \"wikindx-action-title-references\", \"wikindx-action-title-citations\", \"wikindx-action-title-finalize\"]);\r\n    document.getElementById(\"wikindx-display-about\").src = \"../../assets/lightbulb.png\";\r\n  } else {\r\n// Hide About and turn back on what was previously visible\r\n    document.getElementById(\"wikindx-about\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-display-about\").src = \"../../assets/lightbulb_off.png\";\r\n    Visible.retrieveVisible();\r\n    LocalStorage.checkLocalStorage(true);\r\n  }\r\n}\r\n\r\nexport function wikindxDisplayReferencesHelp() {\r\n  // Show Help\r\n  if (document.getElementById(\"wikindx-references-help\").style.display == \"none\") {\r\n    document.getElementById(\"wikindx-citations-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-finalize-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-display-citations-help\").src = \"../../assets/lightbulb_off.png\";\r\n    document.getElementById(\"wikindx-display-finalize-help\").src = \"../../assets/lightbulb_off.png\";\r\n    document.getElementById(\"wikindx-references-help\").style.display = \"block\";\r\n    document.getElementById(\"wikindx-display-references-help\").src = \"../../assets/lightbulb.png\";\r\n  } else {\r\n    // Hide Help\r\n    document.getElementById(\"wikindx-references-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-display-references-help\").src = \"../../assets/lightbulb_off.png\";\r\n  }\r\n}\r\nexport function wikindxDisplayCitationsHelp() {\r\n  // Show Help\r\n  if (document.getElementById(\"wikindx-citations-help\").style.display == \"none\") {\r\n    document.getElementById(\"wikindx-references-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-finalize-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-display-references-help\").src = \"../../assets/lightbulb_off.png\";\r\n    document.getElementById(\"wikindx-display-finalize-help\").src = \"../../assets/lightbulb_off.png\";\r\n    document.getElementById(\"wikindx-citations-help\").style.display = \"block\";\r\n    document.getElementById(\"wikindx-display-citations-help\").src = \"../../assets/lightbulb.png\";\r\n  } else {\r\n    // Hide Help\r\n    document.getElementById(\"wikindx-citations-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-display-citations-help\").src = \"../../assets/lightbulb_off.png\";\r\n  }\r\n}\r\nexport function wikindxDisplayFinalizeHelp() {\r\n  // Show Help\r\n  if (document.getElementById(\"wikindx-finalize-help\").style.display == \"none\") {\r\n    document.getElementById(\"wikindx-citations-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-references-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-display-citations-help\").src = \"../../assets/lightbulb_off.png\";\r\n    document.getElementById(\"wikindx-display-references-help\").src = \"../../assets/lightbulb_off.png\";\r\n    document.getElementById(\"wikindx-finalize-help\").style.display = \"block\";\r\n    document.getElementById(\"wikindx-display-finalize-help\").src = \"../../assets/lightbulb.png\";\r\n  } else {\r\n    // Hide Help\r\n    document.getElementById(\"wikindx-finalize-help\").style.display = \"none\";\r\n    document.getElementById(\"wikindx-display-finalize-help\").src = \"../../assets/lightbulb_off.png\";\r\n  }\r\n}\r\n\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n// images references in the manifest\r\nimport \"../../assets/wikindx-16.png\";\r\nimport \"../../assets/wikindx-32.png\";\r\nimport \"../../assets/wikindx-80.png\";\r\nimport { displayError } from \"./wikindxMessages\";\r\nimport * as Visible from \"./wikindxVisible\";\r\nimport * as Help from \"./wikindxDisplayHelp\";\r\nimport * as Xml from \"./wikindxXml\";\r\nimport * as LocalStorage from \"./wikindxLocalStorage\";\r\nimport * as Styles from \"./wikindxStyles\";\r\nimport * as UrlManagement from \"./wikindxUrlManagement\";\r\nimport * as Finalize from \"./wikindxFinalize\";\r\n//import { testPromise } from \"./testPromise\";\r\n\r\n/* global vars */\r\nvar bibEntry = '';\r\nvar inTextReference = '';\r\nvar citation = '';\r\nvar id = '';\r\nvar initialId = false;\r\nvar errorSearch = \"ERROR: Missing search input.\";\r\nvar errorNoResultsReferences = \"No references found matching your search.\";\r\nvar errorNoResultsCitations = \"No citations found matching your search.\";\r\n// var errorXMLTimeout = \"ERROR: The search timed out. Consider reformulating your search.\"\r\nvar errorMissingID = \"ERROR: Resource or citation ID not found in the selected WIKINDX.\";\r\nvar docSelection;\r\n\r\n\r\n/* global document, Office, Word */\r\n\r\nOffice.onReady(info => {\r\n\r\nOfficeExtension.config.extendedErrorLogging = true;\r\n  if (info.host === Office.HostType.Word) {\r\n  // Determine if the user's version of Office supports all the Office.js APIs that are used in the tutorial.\r\n    if (!Office.context.requirements.isSetSupported('WordApi', '1.3')) {\r\n        console.log('Sorry. The WIKINDX citation tool uses Word.js APIs that are not available in your version of Office.');\r\n    }\r\n  \r\n// Prepare for XMLHTTP connections\r\n    if (Xml.prepareXml() == false) {\r\n      displayError(Xml.errorXMLHTTP);\r\n      return false;\r\n    };\r\n\r\n/** \r\n * Comment out this line in production. Uncommented, it removes all persistent settings in the open document . . .\r\n*/\r\n// Office.context.document.settings.remove('wikindx-id');\r\n\r\n// Assign event handlers and other initialization logic.\r\n    document.getElementById(\"wikindx-search\").onclick = wikindxSearch;\r\n    document.getElementById(\"wikindx-action\").onchange = displayInit;\r\n    document.getElementById(\"wikindx-finalize-run\").onclick = Finalize.finalizeRun;\r\n    document.getElementById(\"wikindx-url\").onchange = Styles.styleSelectBox;\r\n    document.getElementById(\"wikindx-styleSelectBox\").onchange = Visible.reset;\r\n    document.getElementById(\"wikindx-reference-params\").onchange = Visible.reset;\r\n    document.getElementById(\"wikindx-citation-params\").onchange = Visible.reset;\r\n    document.getElementById(\"wikindx-refSelectBox\").onchange = displayReference;\r\n    document.getElementById(\"wikindx-citeSelectBox\").onchange = displayCitation;\r\n    document.getElementById(\"wikindx-insert-reference\").onclick = insertReference;\r\n    document.getElementById(\"wikindx-insert-citation\").onclick = insertCitation;\r\n    document.getElementById(\"wikindx-url-store\").onclick = UrlManagement.urlRegister;\r\n    document.getElementById(\"wikindx-url-add\").onclick = UrlManagement.urlAddDisplay;\r\n    document.getElementById(\"wikindx-url-edit1\").onclick = UrlManagement.urlEditDisplay;\r\n    document.getElementById(\"wikindx-url-edit2\").onclick = UrlManagement.urlEdit;\r\n    document.getElementById(\"wikindx-close-url-entry\").onclick = UrlManagement.wikindxClose;\r\n    document.getElementById(\"wikindx-close-url-edit\").onclick = UrlManagement.wikindxClose;\r\n    document.getElementById(\"wikindx-url-preferred\").onclick = UrlManagement.urlPreferredDisplay;\r\n    document.getElementById(\"wikindx-url-delete\").onclick = UrlManagement.urlDeleteDisplay;\r\n    document.getElementById(\"wikindx-display-about\").onclick = Help.wikindxDisplayAbout;\r\n    document.getElementById(\"wikindx-display-references-help\").onclick = Help.wikindxDisplayReferencesHelp;\r\n    document.getElementById(\"wikindx-display-citations-help\").onclick = Help.wikindxDisplayCitationsHelp;\r\n    document.getElementById(\"wikindx-display-finalize-help\").onclick = Help.wikindxDisplayFinalizeHelp;\r\n    document.getElementById(\"wikindx-url-heartbeat\").onclick = Xml.userCheckHeartbeat;\r\n\r\n//\r\n// For debugging only, uncomment. Otherwise, leave commented out. Uncommented, it will remove all stored URLs from the Office environment. . .\r\n//     window.localStorage.removeItem('wikindx-localStorage');\r\n//\r\n\r\n// Check we have localStorage set up\r\n    LocalStorage.checkLocalStorage(false);\r\n    if (LocalStorage.numStoredURLs) {\r\n      document.getElementById(\"wikindx-action\").style.display = \"block\";\r\n    }\r\n  }\r\n});\r\n\r\nfunction displayInit() {\r\n  document.getElementById(\"wikindx-about\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-display-about\").src = \"../../assets/lightbulb_off.png\";\r\n  if (document.getElementById(\"wikindx-action\").value == 'references') {\r\n    Visible.displayReferencePane();\r\n  } else if (document.getElementById(\"wikindx-action\").value == 'citations') {\r\n    Visible.displayCitationPane();\r\n  } else if (document.getElementById(\"wikindx-action\").value == 'finalize') {\r\n    Visible.displayFinalizePane();\r\n    Finalize.finalizeDisplay();\r\n  }\r\n}\r\n\r\nasync function wikindxSearch() {\r\n/*  var hrReturn = Xml.heartbeat(false);\r\n  if (hrReturn !== true) {\r\n    displayError(hrReturn);\r\n    return false;\r\n  }\r\n*/\r\n  var searchText = document.getElementById(\"wikindx-search-text\").value;\r\n  searchText = searchText.trim();\r\n  searchText = searchText.replace(/[\\u201C\\u201D]/g, '\"'); // Really!!!!! Ensure smart quotes are standard double quotes!!!!!\r\n  if (!searchText) {\r\n    displayError(errorSearch);\r\n    return false;\r\n  }\r\n  if (document.getElementById(\"wikindx-action\").value == 'references') {\r\n    await search('references', searchText);\r\n  } else if (document.getElementById(\"wikindx-action\").value == 'citations') {\r\n    await search('citations', searchText);\r\n  }\r\n}\r\n/**\r\n * After DAYS of trying, this is the best I can do.... TODO - remove the sleep promise thingamijig and still have it working!\r\n * \r\n */\r\nfunction sleep(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nasync function search(type, searchText) {\r\n  document.getElementById(\"wikindx-search-completed\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-working\").style.display = \"block\"; \r\n  await sleep(13); // seems to be the smallest value possible . . .\r\n  if (type == 'references') {\r\n    searchReferences(searchText);\r\n  } else {\r\n    searchCitations(searchText);\r\n  }\r\n  document.getElementById(\"wikindx-search-working\").style.display = \"none\";\r\n  document.getElementById(\"wikindx-search-completed\").style.display = \"block\";\r\n}\r\n\r\nfunction searchCitations(searchText) {\r\n  Xml.getSearchInputCitations(searchText);\r\n  if (Xml.xmlResponse == null) {\r\n    displayError(errorNoResultsCitations);\r\n    return false;\r\n  }\r\n  printSearchResultsCitations();\r\n  return true;\r\n}\r\n\r\nfunction searchReferences(searchText) {\r\n  Xml.getSearchInputReferences(searchText);\r\n  if (Xml.xmlResponse == null) {\r\n    displayError(errorNoResultsReferences);\r\n    return false;\r\n  }\r\n  printSearchResultsReferences();\r\n  return true;\r\n}\r\n\r\nfunction printSearchResultsReferences() {\r\n  var refSelectBox = document.getElementById(\"wikindx-refSelectBox\");\r\n  var len = Xml.xmlResponse.length;\r\n  var i;\r\n  var text = '';\r\n\r\n  for (i = 0; i < len; i++) {\r\n    bibEntry = Xml.xmlResponse[i].bibEntry;\r\n    id = Xml.xmlResponse[i].id;\r\n    text += '<option value=\"' + id + '\">' + bibEntry + '</option>';\r\n    if (i == 0) {\r\n      initialId = id;\r\n    }\r\n  }\r\n  displayReference();\r\n  refSelectBox.innerHTML = text;\r\n  Visible.endPrintReference();\r\n}\r\n\r\nfunction printSearchResultsCitations() {\r\n  var citeSelectBox = document.getElementById(\"wikindx-citeSelectBox\");\r\n  var len = Xml.xmlResponse.length;\r\n  var i;\r\n  var text = '';\r\n\r\n  for (i = 0; i < len; i++) {\r\n    citation = Xml.xmlResponse[i].citation;\r\n    id = Xml.xmlResponse[i].id;\r\n    text += '<option value=\"' + id + '\">' + citation + '</option>';\r\n    if (i == 0) {\r\n      initialId = id;\r\n    }\r\n  }\r\n  displayCitation();\r\n  citeSelectBox.innerHTML = text;\r\n  Visible.endPrintCitation();\r\n}\r\n\r\nfunction displayReference() {\r\n  getReference();\r\n  if (Xml.xmlResponse == 'Bad ID') {\r\n    displayError(errorMissingID);\r\n    return false;\r\n  }\r\n  bibEntry = Xml.xmlResponse.bibEntry;\r\n  document.getElementById(\"wikindx-display-ref\").innerHTML = '</br>' + bibEntry;\r\n  return true;\r\n}\r\n\r\nfunction displayCitation() {\r\n  getCitation();\r\n  if (Xml.xmlResponse == 'Bad ID') {\r\n    displayError(errorMissingID);\r\n    return false;\r\n  }\r\n  citation = Xml.xmlResponse.citation;\r\n  bibEntry = Xml.xmlResponse.bibEntry;\r\n  document.getElementById(\"wikindx-display-cite\").innerHTML = '</br>' + citation + '<br/><br/>' + bibEntry;\r\n  return true;\r\n}\r\n\r\nfunction getReference() {\r\n  if (!initialId) {\r\n    var id = document.getElementById(\"wikindx-refSelectBox\").value;\r\n  } else {\r\n    var id = initialId;\r\n    initialId = false;\r\n  }\r\n  Xml.getReference(id);\r\n}\r\n\r\nfunction getCitation() {\r\n  if (!initialId) {\r\n    var id = document.getElementById(\"wikindx-citeSelectBox\").value;\r\n  } else {\r\n    var id = initialId;\r\n    initialId = false;\r\n  }\r\n  Xml.getCitation(id);\r\n}\r\n\r\nfunction insertReference() {\r\n  Word.run(async function (context) {\r\n/*    var hrReturn = Xml.heartbeat(false);\r\n    if (hrReturn !== true) {\r\n      displayError(hrReturn);\r\n      return;\r\n    }\r\n*/    getReference();\r\n    if (Xml.xmlResponse == 'Bad ID') {\r\n      displayError(errorMissingID);\r\n      return;\r\n    }\r\n    inTextReference = Xml.xmlResponse.inTextReference;\r\n    docSelection = context.document.getSelection();\r\n    var cc = docSelection.insertContentControl();\r\n    cc.color = 'orange';\r\n    cc.tag = 'wikindx-id-' + btoa(JSON.stringify([Xml.selectedURL, Xml.xmlResponse.id]));\r\n    cc.title = Xml.xmlResponse.titleCC;\r\n    console.log(Xml.xmlResponse.titleCC);\r\n    cc.insertHtml(inTextReference, \"Replace\");\r\n    await context.sync();\r\n  })\r\n  .catch(function (error) {\r\n      console.log(\"Error: \" + error);\r\n      if (error instanceof OfficeExtension.Error) {\r\n          console.log(\"Debug info: \" + JSON.stringify(error.debugInfo));\r\n          displayError(JSON.stringify(error));\r\n          return false;\r\n      }\r\n  });\r\n}\r\n\r\nfunction insertCitation() {\r\n  Word.run(async function (context) {\r\n/*    var hrReturn = Xml.heartbeat(false);\r\n    if (hrReturn !== true) {\r\n      displayError(hrReturn);\r\n      return ;\r\n    }\r\n*/    getCitation();\r\n    if (Xml.xmlResponse == 'Bad ID') {\r\n      displayError(errorMissingID);\r\n      return;\r\n    }\r\n    inTextReference = Xml.xmlResponse.inTextReference;\r\n    citation = Xml.xmlResponse.citation;\r\n    docSelection = context.document.getSelection();\r\n    context.load(docSelection, 'font/size, font/name, font/color');\r\n    await context.sync();\r\n    var cc = docSelection.insertContentControl();\r\n    cc.color = 'orange';\r\n    cc.tag = 'wikindx-id-' + btoa(JSON.stringify([Xml.selectedURL, Xml.xmlResponse.id, Xml.xmlResponse.metaId]));\r\n    cc.title = Xml.xmlResponse.titleCC;\r\n    cc.insertHtml(inTextReference, \"Replace\");\r\n    var ccRange = cc.getRange('Whole');\r\n    if (document.getElementById(\"wikindx-citation-html\").checked) {\r\n      ccRange.insertHtml(citation + '&nbsp;', \"Before\").font.set({\r\n        size: docSelection.font.size,\r\n        color: docSelection.font.color,\r\n        name: docSelection.font.name\r\n      });\r\n    } else {\r\n      ccRange.insertHtml(citation + '&nbsp;', \"Before\");\r\n    }\r\n    await context.sync();\r\n    })\r\n  .catch(function (error) {\r\n      console.log(\"Error: \" + error);\r\n      if (error instanceof OfficeExtension.Error) {\r\n          console.log(\"Debug info: \" + JSON.stringify(error.debugInfo));\r\n          displayError(JSON.stringify(error));\r\n          return false;\r\n      }\r\n  });\r\n}\r\n"],"sourceRoot":""}